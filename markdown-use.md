# 使用指南

**flux-panel** 是一个基于 go-gost 的现代化转发面板，提供了直观的 Web 界面来管理网络流量转发。

## 项目介绍

### 核心功能
- 🔄 **TCP/UDP/TLS 端口转发**：支持多种协议的流量转发  
- 👥 **用户管理**：按账号级别管理流量转发数量和流量限额  
- 📊 **流量统计**：支持双向/单向计费模式，实时监控  
- ⚡ **限速控制**：可创建限速规则进行精细化流量控制  
- 🖥️ **节点管理**：分布式节点部署和监控  
- 🚇 **隧道管理**：灵活的隧道配置和管理  
- 🔒 **安全可控**：内置认证系统，权限分级管理  

### 技术架构
| 组件       | 技术栈          |
|------------|----------------|
| 前端     | vite + next UI  |
| 后端       | Spring Boot + MySQL |
| 转发引擎   | go-gost        |
| 部署方式   | Docker Compose |


## 第一步：登录系统
1. 安装完成后，打开浏览器访问面板地址：
   ```
   http://your-server-ip:6366
   ```
2. 使用默认管理员账号登录：
   - **用户名**: `admin_user`
   - **密码**: `admin_user`


## 第二步：修改默认密码
登录后**务必立即修改默认密码**

## 第三步：创建节点
节点是运行转发服务的服务器，需要先创建节点才能部署转发服务。

### 添加节点
1. 在左侧菜单点击 **节点管理**
2. 点击 **新增节点** 按钮
3. 填写节点信息：
   | 字段         | 说明                                  | 示例               |
   |--------------|---------------------------------------|--------------------|
   | 节点名称     | 自定义名称                            | 香港节点-01        |
   | 服务器IP     | 节点服务器的主通信IP                  | 192.168.1.100      |
   | 入口IP       | 面向用户的访问地址                   | 203.0.113.5       |
   | 端口范围     | 允许分配的端口范围                    | 20000-30000       |

::: tip 特殊情况
如NAT服务器端口范围不连续，可输入 `1-65535`，后续转发时手动指定端口。
:::
4. 点击 "**确定**" 保存节点
### IP地址说明：
**服务器IP**：
- 用于创建隧道转发时入口-出口两台服务器之间的通信地址
- 通常是服务器的主要通信IP
- 确保入口和出口节点能够通过此IP互相访问

**入口IP**：
- 用于展示在转发页面，面向用户的访问地址
- 适用于有多个IP的服务器（如多线BGP）

*兜底提示：* 

*实在理解不到说明你没这个需求，都填节点的公网ip就行*

## 第四步：安装节点Agent
创建节点后需在对应服务器安装Agent

### 获取安装命令
1. 节点列表中找到目标节点
2. 点击卡片中的 **复制** 按钮
3. 系统会自动复制安装命令到剪贴板

### 执行安装
在目标服务器执行命令：
```bash
# 示例安装命令（实际命令请从面板复制）
curl -L https://your-panel-server:6365/agent/install | bash -s -- --server=your-panel-server:6365 --token=your-node-token
```
::: warning 安装须知
 - 若 `/etc/gost/` 存在 `gost.json` 则跳过配置生成
 - gost执行文件会强制更新
:::

### 验证安装
安装完成后查看面板节点状态：
- 状态变为 🟢 **在线**
- 显示 CPU/内存 等系统信息


## 第五步：创建隧道
隧道定义流量的入口和出口节点

### 添加隧道
1. 左侧菜单点击 "**隧道管理**
2. 点击 "**新增隧道**"
3. 配置隧道参数：

**基本信息**：
- **隧道名称**: 自定义名称（如：Web服务隧道）
- **隧道类型**:
    - 端口转发: 在单个节点上进行直接端口映射
    - 隧道转发: 在入口节点和出口节点之间建立隧道连接
- **流量计算**:
    - 单向计算（仅上传）：仅计算上传流量
    - 双向计算：计算上传和下载的总流量
- **流量倍率**: 计费倍率（默认1.0，设置为2.0表示按实际流量的2倍计费围：1.0-10.0）
入口配置：

**入口配置**: 
- **入口节点**：选择流量入口节点

- **监听地址**:

::: tip 说明

部分专线需要监听指定内网IP才能成功转发端口，所以才诞生了这两个配置。如果不理解就按照说明填写，服务器只有v4就填写 0.0.0.0，支持v6或者只有v6就填写 [::]
:::

**出口配置**（仅隧道转发类型需要）：

- 协议类型: 保持默认即可，如有特殊需求可选择：
- 出口节点: 选择流量出口节点
4. 点击 "**创建**" 保存隧道

## 第六步：创建转发
转发规则定义具体端口映射

### 添加转发
1. 左侧菜单点击 **转发管理**
2. 点击 **新增转发**
3. 配置参数：
   | 配置项       | 说明                                  |
   |--------------|---------------------------------------|
   | 转发名称     | 自定义名称 (如: SSH转发)             |
   | 选择隧道     | 已创建的隧道                          |
   | 入口端口     | 留空自动分配或手动指定                 |
   | 远程地址     | 支持格式：<br> • `192.168.1.100:8080`<br> • `[2001:db8::1]:8080`<br> • `example.com:8080` |

:::tip 注意
支持输入多个远程地址，多个地址时可选择负载均衡模式。
:::
4. 点击 "**确定**" 保存转发规则

## 第七步：用户管理 (可选)
如果需要多用户使用，可以创建普通用户账号并分配资源。
### 创建用户
1. 左侧菜单点击 **用户管理**
2. 点击 **新增用户**
3. 填写信息：
   | 选项         | 说明                          | 特殊值说明         |
   |--------------|-------------------------------|--------------------|
   | 流量(GB)     | 总流量限额                    | 999999 = 无限制    |
   | 转发数量     | 可创建转发数量                | 999999 = 无限制    |
   | 过期时间     | 账号有效期                    |                    |
   | 流量重置     | 重置周期                      | 默认每月1号0点     |

### 分配隧道权限
创建用户后，需要为用户分配具体的隧道使用权限：

1. 在用户列表中找到目标用户
2. 点击用户的 "隧道权限管理" 按钮
3. 在弹出窗口中配置权限：

**分配新隧道权限**：

- **选择隧道**: 选择要分配给用户的隧道
- **流量限制**(GB): 该隧道的流量限额
- **转发数量**: 该隧道允许创建的转发数量
- **到期时间**: 该隧道权限的有效期
- **限速规则**: 选择是否应用限速（默认"不限速"）
点击 "**分配权限**" 保存配置

**权限管理**：

- 在"已有隧道权限"列表中可以查看用户的所有隧道权限
- 显示每个隧道的状态、流量统计、转发数量、限速规则、到期时间
- 可以编辑或删除现有权限

### 权限优先级说明
系统采用两级权限管理，优先级如下：

**用户级别权限（优先级最高）**：

- 用户的流量限额和转发数量限制影响该用户的所有转发
- 即使隧道权限设置更大的限额，也不能超过用户级别的总限制
- 例如：用户总流量100GB，即使单个隧道分配200GB，用户实际最多只能使用100GB

**隧道级别权限**：

- 隧道的流量和转发数量限制只影响对应的隧道
- 在用户总限额范围内，进一步细分到具体隧道的使用限制
- 例如：用户总流量100GB，可以分配给隧道A 60GB，隧道B 40GB


## 第八步：限速规则 (可选)
如果需要对特定用户或隧道进行限速，需要先创建限速规则。
### 创建限速规则
1. 在左侧菜单点击 "**限速规则**"
2. 点击 "**新增限速**" 按钮
3. 配置限速参数：

**基本配置**：

- **规则名称**: 自定义限速规则名称（如：游戏隧道限速）
- **速度限制**: 设置带宽限制值
    - 单位：Mbps（兆比特每秒）
    - 范围：1-1000000 Mbps
    - 例如：100 表示限制带宽为100Mbps
- **绑定隧道**: 选择要应用此限速规则的隧道
4. 点击 "**确定**" 保存限速规则


## 第九步：API流量查询 (可选)
- 本项目为sub-store提供流量查询API以便查询流量日期信息
- 格式如下
```
http(s)://<面板连接地址>/api/v1/open_api/sub_store?user=<用户名>&pwd=<密码>&tunnel=<隧道ID>
```
- 修改完成后填入sub-store订阅流量信息栏即可实现查询 注意
- “&tunnel=隧道id”为可选项，若不填写则返回全部流量查询信息
- 管理员无此查询权限
- 请妥善保存上述信息，避免因用户信息泄漏而造成的损失
## 获取帮助
📖 **社区支持资源**：
- [快速开始指南](/markdown-start.md)
- [常见问题解答](/markdown-question.md)
## 免责声明
本项目仅供个人学习与研究使用，基于开源项目进行二次开发。使用本项目所带来的任何风险由使用者自行承担。请确保在合法、合规、安全的前提下使用本项目。